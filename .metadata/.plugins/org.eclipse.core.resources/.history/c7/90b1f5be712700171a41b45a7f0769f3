package com.ads.autodata;

import java.io.IOException;
import java.util.ArrayList;

import com.object.*;
import org.jsoup.Jsoup;
import org.jsoup.nodes.*;
import org.jsoup.select.Elements;

public class GetDataImpl implements GetData {

	@Override
	public ProductObject getData(String url) {
		ProductObject item = new ProductObject();
		Document doc = null;
		try {
			doc = Jsoup.connect(url).get();
			Elements e = null;
			if(url.contains("trananh.vn")){
				e = doc.getElementsByClass(DataConstant.PRPRIMARYTA);
				item.setProduct_name(e.select(DataConstant.PRNAMETA).text());
				item.setProduct_summary(e.select(DataConstant.PRSUMMARYTA).text());
				if(e.select(DataConstant.PRSTATUSTA).text().equalsIgnoreCase("Còn hàng")){
					item.setProduct_status(true);
				}else{
					item.setProduct_status(false);
				}
				if(e.select(DataConstant.PRWARRANTYTA).isEmpty()){
					item.setProduct_warranty_time(0);
				}else{
				item.setProduct_warranty_time(Integer.parseInt(e.select(DataConstant.PRWARRANTYTA).text().trim().substring(e.select(DataConstant.PRWARRANTYTA).text().indexOf(": ")+2, (e.select(DataConstant.PRWARRANTYTA).text().indexOf(": ") + 4))));
				}
				if(e.select(DataConstant.PRPRICETA).isEmpty()){
					item.setProduct_origin_price(0);
				}else{
				item.setProduct_origin_price(Integer.parseInt(e.select(DataConstant.PRPRICETA).text().trim().replace(".", "0").substring(0,(e.select(DataConstant.PRPRICETA).text().trim().replace(".", "0").length()-2))));
				}
			}else{
			item = null;
			}
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return item;
	}

	@Override
	public ArrayList<WebObject> getDatas(String url) {
		// TODO Auto-generated method stub
		return null;
	}
	
	public static void main(String[] args){
		GetData gd = new GetDataImpl();
		ProductObject productObject = gd.getData("https://www.trananh.vn/do-gia-dung/quat-dieu-hoa-sunhouse-shd7742-pid195146cid408");
		if(productObject != null){
		System.out.println(productObject.getProduct_name());
		System.out.println(productObject.getProduct_origin_price());
		System.out.println(productObject.getProduct_warranty_time());
		System.out.println(productObject.isProduct_status());
		}
		else{
			System.out.println("Trang web chưa được thêm vào! Liên hệ với quản trị để được hướng dẫn thêm.");
		}
	}
}
